<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Japan Tokyoï½œæ—…ã™ã‚‹æ‰‹å¸³ï¼ˆWebï¼‰</title>

  <link
    href="https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Noto+Sans+TC:wght@400;600;700&family=Noto+Sans+JP:wght@400;600;700&display=swap"
    rel="stylesheet">

  <style>
    :root {
      --ink: #233;
      --muted: #667;
      --glass: rgba(255, 255, 255, .72);
      --glass2: rgba(255, 255, 255, .82);
      --shadow: 0 12px 30px rgba(0, 0, 0, .14);
      --shadow2: 0 8px 22px rgba(0, 0, 0, .12);
      --blue1: #8dd0ff;
      --blue2: #5bb8ff;
      --blue3: #4b77ff;
      --chip: #eaf4ff;
      --accent: #ff9f3a;
      --ok: #6fcf97;
      --danger: #ff6b6b;
      --tab: #ffffff;
      --tabActive: #5473ff;
      --tabText: #2a3b55;
      --tabTextActive: #fff;
      --radius: 26px;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Noto Sans TC', 'Noto Sans JP', sans-serif;
      color: var(--ink);
      background: #cfe9ff;
      overflow-x: hidden;
    }

    /* èƒŒæ™¯ï¼šè—å¤©æ„Ÿ */
    .bg {
      position: fixed;
      inset: 0;
      background:
        radial-gradient(1200px 700px at 30% 20%, rgba(255, 255, 255, .75), rgba(255, 255, 255, 0) 60%),
        radial-gradient(900px 600px at 70% 30%, rgba(255, 255, 255, .65), rgba(255, 255, 255, 0) 55%),
        linear-gradient(180deg, #cfe9ff 0%, #9fd5ff 45%, #75bfff 100%);
      z-index: -2;
    }

    .bg::after {
      content: "";
      position: absolute;
      inset: -40px;
      background:
        url("https://www.transparenttextures.com/patterns/paper-fibers.png"),
        url("https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1400&q=60");
      background-size: 300px 300px, cover;
      background-position: center;
      opacity: .18;
      filter: blur(6px);
      transform: scale(1.04);
      z-index: -1;
    }

    .itemSub {
      font-family: 'Noto Sans JP', 'Noto Sans TC', sans-serif;
      letter-spacing: .3px;
      opacity: .85;
    }

    .dayTab .d {
      font-family: 'Noto Sans JP', 'Patrick Hand';
      font-weight: 600;
    }



    /* App å®¹å™¨ */
    .app {
      max-width: 420px;
      margin: 0 auto;
      padding: 14px 14px 170px;
    }

    /* é ‚éƒ¨ title */
    .topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 6px 12px;
      color: #1f3b57;
    }

    .brand {
      font-family: 'Patrick Hand';
      font-size: 28px;
      letter-spacing: .5px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .brand .leaf {
      width: 22px;
      height: 22px;
      border-radius: 8px;
      background: linear-gradient(180deg, #7cffb0, #2ecb73);
      display: inline-block;
      box-shadow: 0 6px 14px rgba(46, 203, 115, .25);
      transform: rotate(-12deg);
    }

    .rate {
      font-size: 12px;
      opacity: .9;
      background: rgba(255, 255, 255, .55);
      padding: 8px 10px;
      border-radius: 14px;
      box-shadow: 0 6px 16px rgba(0, 0, 0, .08);
    }

    /* Info å¡ï¼ˆå¤©æ°£/åŒ¯ç‡/å®šä½/æ—¥æœŸï¼‰ */
    .infoCard {
      background: rgba(255, 255, 255, .7);
      border-radius: 24px;
      padding: 14px;
      box-shadow: var(--shadow2);
      backdrop-filter: blur(10px);
    }

    .infoRow {
      display: flex;
      gap: 12px;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
    }

    .weatherBox {
      display: flex;
      align-items: center;
      gap: 10px;
      min-width: 170px;
    }

    .wxIcon {
      width: 44px;
      height: 44px;
      border-radius: 16px;
      background: linear-gradient(180deg, #e8f6ff, #bfe7ff);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 8px 20px rgba(0, 0, 0, .08);
      font-size: 24px;
    }

    .wxMain {
      display: flex;
      flex-direction: column;
      line-height: 1.1;
    }

    .temp {
      font-size: 28px;
      font-weight: 800;
      letter-spacing: .2px;
    }

    .wxDesc {
      font-size: 12px;
      color: var(--muted);
    }

    .locChip {
      display: flex;
      align-items: center;
      gap: 8px;
      background: rgba(255, 255, 255, .7);
      padding: 10px 12px;
      border-radius: 18px;
      box-shadow: 0 8px 18px rgba(0, 0, 0, .08);
      font-size: 12px;
      color: #2a4a6a;
    }

    .dateChip {
      background: rgba(255, 255, 255, .6);
      padding: 10px 12px;
      border-radius: 18px;
      font-size: 12px;
      color: #2a4a6a;
      box-shadow: 0 8px 18px rgba(0, 0, 0, .08);
    }

    /* Day Tabs */
    .dayTabsWrap {
      margin-top: 12px;
      background: rgba(255, 255, 255, .62);
      border-radius: 22px;
      padding: 10px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, .10);
      backdrop-filter: blur(10px);
      overflow: hidden;
    }

    .dayTabs {
      display: flex;
      gap: 10px;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      padding-bottom: 4px;
    }

    .dayTabs::-webkit-scrollbar {
      height: 0;
    }

    .dayTab {
      flex: 0 0 auto;
      width: 92px;
      padding: 12px 10px;
      border-radius: 18px;
      background: rgba(255, 255, 255, .85);
      box-shadow: 0 10px 18px rgba(0, 0, 0, .08);
      text-align: center;
      color: var(--tabText);
      cursor: pointer;
      user-select: none;
      transition: .18s;
    }

    .dayTab .d {
      font-size: 12px;
      opacity: .85;
      font-weight: 700;
      letter-spacing: .2px;
    }

    .dayTab .num {
      font-size: 26px;
      font-weight: 900;
      margin-top: 4px;
      letter-spacing: .6px;
    }

    .dayTab.active {
      background: linear-gradient(180deg, rgba(84, 115, 255, .95), rgba(64, 92, 230, .95));
      color: var(--tabTextActive);
      transform: translateY(-1px);
      box-shadow: 0 14px 25px rgba(84, 115, 255, .28);
    }

    .dayTab.active .d {
      opacity: .95;
    }

    /* section title */
    .sectionTitleRow {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin: 14px 4px 8px;
      gap: 10px;
    }

    .sectionTitle {
      font-size: 20px;
      font-weight: 900;
      letter-spacing: .2px;
      background: rgba(255, 255, 255, .55);
      padding: 8px 12px;
      border-radius: 16px;
      box-shadow: 0 8px 18px rgba(0, 0, 0, .08);
    }

    .btnPill {
      border: none;
      border-radius: 18px;
      padding: 10px 12px;
      background: rgba(255, 255, 255, .55);
      box-shadow: 0 8px 18px rgba(0, 0, 0, .08);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 700;
      color: #2a4a6a;
    }

    .btnPill.primary {
      background: rgba(84, 115, 255, .16);
    }

    /* itinerary cards */
    .list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .itemCard {
      background: rgba(255, 255, 255, .84);
      border-radius: 24px;
      padding: 14px 14px 12px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
      position: relative;
      overflow: hidden;
      border-radius: 26px 26px 22px 22px;
    }

    .itemCard::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(400px 180px at 10% 10%, rgba(141, 208, 255, .35), rgba(255, 255, 255, 0) 55%);
      pointer-events: none;
    }

    .itemCard::after {
      content: "";
      position: absolute;
      bottom: 0;
      left: 20px;
      right: 20px;
      height: 6px;
      background: rgba(0, 0, 0, 0.03);
      border-radius: 50%;
    }

    .itemTop {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 10px;
      position: relative;
      z-index: 1;
    }

    .itemTitle {
      font-weight: 900;
      font-size: 16px;
      line-height: 1.25;
    }

    .itemSub {
      color: var(--muted);
      font-size: 12px;
      margin-top: 6px;
      line-height: 1.35;
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 14px;
      background: rgba(255, 255, 255, .7);
      font-size: 12px;
      box-shadow: 0 8px 18px rgba(0, 0, 0, .08);
      white-space: nowrap;
    }

    .btnMap {
      border: none;
      border-radius: 18px;
      padding: 10px 14px;
      background: rgba(255, 159, 58, .95);
      color: #fff;
      font-weight: 900;
      cursor: pointer;
      box-shadow: 0 12px 24px rgba(255, 159, 58, .28);
      min-width: 98px;
    }

    /* Pages */
    .page {
      display: none;
    }

    .page.active {
      display: block;
    }

    /* Bottom Nav */
    .bottomNav {
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: 16px;
      width: min(420px, calc(100% - 28px));
      background: rgba(255, 255, 255, .88);
      border-radius: 32px;
      box-shadow: 0 14px 34px rgba(0, 0, 0, .18);
      padding: 12px 10px;
      display: flex;
      justify-content: space-around;
      gap: 6px;
      backdrop-filter: blur(12px);
    }

    .bItem {
      width: 20%;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      font-size: 12px;
      color: #52667a;
      cursor: pointer;
      user-select: none;
    }

    .bIcon {
      width: 54px;
      height: 54px;
      border-radius: 26px;
      background: rgba(255, 255, 255, .9);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 10px 20px rgba(0, 0, 0, .10);
      font-size: 22px;
      transition: .18s;
    }

    .bItem.active .bIcon {
      transform: translateY(-2px);
      background: rgba(84, 115, 255, .14);
      box-shadow: 0 16px 26px rgba(84, 115, 255, .20);
    }

    .bItem.active {
      color: #2b4661;
      font-weight: 900;
    }

    /* small helper */
    .muted {
      color: var(--muted);
    }

    .divider {
      height: 10px;
    }

    .tiny {
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 12px;
      padding: 8px 12px;
      background: rgba(255, 255, 255, .55);
      border-radius: 12px;
      display: inline-block;
    }

    /* Map page list card style reuse */
    .simpleCard {
      background: rgba(255, 255, 255, .84);
      border-radius: 22px;
      padding: 14px;
      box-shadow: var(--shadow2);
      margin: 12px 0;
    }

    .rowBetween {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      align-items: center;
    }

    .pill {
      background: rgba(84, 115, 255, .12);
      color: #2a4a6a;
      padding: 8px 10px;
      border-radius: 14px;
      font-size: 12px;
      font-weight: 800;
      display: inline-flex;
      gap: 6px;
      align-items: center;
    }

    .btnGhost {
      border: none;
      border-radius: 14px;
      padding: 10px 12px;
      background: rgba(255, 255, 255, .75);
      box-shadow: 0 8px 18px rgba(0, 0, 0, .08);
      font-weight: 900;
      cursor: pointer;
      color: #2a4a6a;
      white-space: nowrap;
    }

    .expenseItem {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      padding: 10px 0;
      border-bottom: 1px dashed rgba(0, 0, 0, .08);
    }

    .expenseItem:last-child {
      border-bottom: none;
    }

    .expenseMeta {
      font-size: 12px;
      color: var(--muted);
    }

    .expenseAmount {
      font-weight: 900;
    }

    .expenseRow {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
    }

    .expenseMeta {
      font-size: 12px;
      color: var(--muted);
    }

    .expenseActions {
      display: flex;
      gap: 6px;
    }

    .pie {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      background: conic-gradient(var(--pie));
      margin: 10px auto;
    }
  </style>
</head>

<body>
  <div class="bg"></div>

  <div class="app">
    <div class="topbar">
      <div class="brand"><span class="leaf"></span> Japan Tokyo</div>
      <div class="rate" id="rateBox">ç›®å‰åŒ¯ç‡ï½œ<b>1 JPY â‰ˆ 0.27 TWD</b></div>
    </div>

    <!-- Info Card -->
    <div class="infoCard">
      <div class="infoRow">
        <div class="weatherBox">
          <div class="wxIcon">â›…</div>
          <div class="wxMain">
            <div class="temp" id="tempBox">12Â°C</div>
            <div class="wxDesc" id="wxDesc">æ™´æ™‚å¤šé›²ï½œæ™´ã‚Œæ™‚ã€…æ›‡ã‚Š</div>
          </div>
        </div>

        <div class="locChip">ğŸ“ æ±äº¬ï½œTokyo</div>
        <div class="dateChip" id="dateRange"></div>
        <div class="dateChip" id="countdownBox">â³ è¨ˆç®—ä¸­â€¦</div>

      </div>

      <!-- Day Tabs -->
      <div class="dayTabsWrap">
        <div class="dayTabs" id="dayTabs"></div>
      </div>
    </div>

    <!-- Pages -->
    <section class="page active" id="page-trip">
      <div class="sectionTitleRow">
        <div class="sectionTitle">è¡Œç¨‹å®‰æ’ <span class="muted">Itinerary</span></div>
        <button class="btnPill primary" onclick="addItem()">ï¼‹ æ–°å¢</button>
      </div>
      <div class="list" id="tripList"></div>
      <div class="divider"></div>
      <div class="tiny muted">æç¤ºï¼šå¯åœ¨æ¯é …è¡Œç¨‹æŒ‰ã€Œå°èˆª MAPã€ç›´æ¥é–‹ Google Mapsã€‚</div>
    </section>

    <section class="page" id="page-map">
      <div class="sectionTitleRow">
        <div class="sectionTitle">åœ°åœ– <span class="muted">Map</span></div>
        <button class="btnPill" onclick="openTodayRoute()">ğŸ§­ ä»Šæ—¥è·¯ç·š</button>
      </div>
      <div id="mapList"></div>
    </section>

    <section class="page" id="page-expense">
      <div class="sectionTitleRow">
        <div class="sectionTitle">è¨˜å¸³ <span class="muted">Expense</span></div>
        <!-- <div class="dayTabs" id="expenseDayTabs"></div> -->
        <div style="display:flex; gap:8px;">
          <button class="btnPill primary" onclick="openExpenseSheet()">ï¼‹ è¨˜ä¸€ç­†</button>
          <button class="btnPill" onclick="exportExpenseCSV()">â¬‡ åŒ¯å‡º</button>
        </div>
      </div>

      <div class="simpleCard">
        <div class="rowBetween">
          <div><b>æ—…é€”æ”¯å‡ºç¸½è¨ˆ</b></div>
          <div class="pill">
            Â¥ <span id="expenseTotalJPY">0</span><br>
            â‰ˆ NT$ <span id="expenseTotalTWD">0</span>
          </div>
        </div>
      </div>

      <div class="simpleCard">
        <b>åˆ†é¡æ¯”ä¾‹</b>
        <div id="expensePie" style="margin-top:12px;"></div>
      </div>

      <div id="expenseList"></div>
    </section>



    <section class="page" id="page-shopping">
      <div class="sectionTitleRow">
        <div class="sectionTitle">è³¼ç‰© <span class="muted">List</span></div>
        <button class="btnPill" onclick="alert('ä¸‹ä¸€æ­¥åšï¼šè³¼ç‰©æ¸…å–®ï¼ˆå‹¾é¸/åˆ†é¡/é ç®—ï¼‰')">ï¼‹ æ–°å¢</button>
      </div>
      <div class="simpleCard">ğŸ› è³¼ç‰©æ¸…å–®è£½ä½œä¸­ï¼ˆä¸‹ä¸€æ­¥å¯åšï¼šå‹¾é¸å®Œæˆã€åˆ†é¡ã€åƒ¹æ ¼ï¼‰</div>
    </section>

    <section class="page" id="page-info">
      <div class="sectionTitleRow">
        <div class="sectionTitle">è³‡è¨Š <span class="muted">Info</span></div>
        <button class="btnPill" onclick="alert('ä¸‹ä¸€æ­¥å¯åŠ å…¥ï¼šäº¤é€šå¡/æ©Ÿå ´äº¤é€š/é¤å»³å£è¢‹åå–®/æ³¨æ„äº‹é …')">ï¼‹ æ–°å¢</button>
      </div>
      <div class="simpleCard">
        <b>å‡ºç™¼ï¼š</b>2026/11/30ï¼ˆå°ç£é€±ä¸€ï½œæ—¥æœ¬æœˆæ›œæ—¥ï¼‰<br>
        <b>å›ç¨‹ï¼š</b>2026/12/05ï¼ˆå°ç£é€±å…­ï½œæ—¥æœ¬åœŸæ›œæ—¥ï¼‰<br><br>
        <div class="pill">ğŸ¡ Disneyï¼šDay 4ï¼ˆä¸ç´¯ç‰ˆï¼‰</div><br><br>
        <div class="pill">â­ å°å ´ç…™ç«ï¼šDay 6ï¼ˆèˆ‡ Disney ä¸éš”å¤© âœ…ï¼‰</div><br><br>
        <div class="pill">ğŸƒ Level 2ï¼šå‰åœåŠ›æ¼«éŠï¼ˆå¯åˆ‡æ›åŠ å…¥ Day 5/ä»»ä¸€å¤©ï¼‰</div>
      </div>
    </section>
  </div>

  <!-- Bottom Nav -->
  <div class="bottomNav">
    <div class="bItem active" onclick="switchPage('trip', this)">
      <div class="bIcon">ğŸ“…</div>
      è¡Œç¨‹
    </div>
    <div class="bItem" onclick="switchPage('map', this)">
      <div class="bIcon">ğŸ—ºï¸</div>
      åœ°åœ–
    </div>
    <div class="bItem" onclick="switchPage('expense', this)">
      <div class="bIcon">ğŸ’´</div>
      è¨˜å¸³
    </div>
    <div class="bItem" onclick="switchPage('shopping', this)">
      <div class="bIcon">ğŸ›ï¸</div>
      è³¼ç‰©
    </div>
    <div class="bItem" onclick="switchPage('info', this)">
      <div class="bIcon">â„¹ï¸</div>
      è³‡è¨Š
    </div>
  </div>

  <script>

    // ====== API è¨­å®š ======
    const OPENWEATHER_API_KEY = "ce48502f2066d3567b5a41ede9e7169f";

    // æ±äº¬ï¼ˆå›ºå®šï¼‰
    const TOKYO_LAT = 35.681236;
    const TOKYO_LON = 139.767125;

    // ====== æ¯æ—¥å¤©æ°£å¿«å–ï¼ˆDay Tabs ç”¨ï¼‰======
    let dailyWeather = {};

    // ====== æ—¥æœŸï¼ˆä½ çµ¦çš„ï¼‰======
    const START_DATE = "2026-11-30";
    const END_DATE = "2026-12-05"; // 7å¤©6å¤œï¼š11/30~12/05ï¼ˆå…±6æ™šï¼‰

    // ====== Day è³‡æ–™ï¼ˆä½ çµ¦çš„è¡Œç¨‹ï¼‰======
    // æ¯å¤©å¯æœ‰å¤šå€‹é …ç›®ï¼štitle/sub/place(åœ°é»å­—ä¸²çµ¦Google Maps)
    let data = JSON.parse(localStorage.getItem("emenuTokyo")) || {
      selectedDay: 1,
      days: [
        {
          labelZh: "DAY1",
          labelJp: "åˆ°ç€",
          date: "2026-11-30",
          items: [
            { title: "æŠµé”æ±äº¬ âœˆï¸ï¼å…¥ä½é£¯åº—", sub: "æ±äº¬é§…ãƒ»ãƒ›ãƒ†ãƒ« ãƒã‚§ãƒƒã‚¯ã‚¤ãƒ³", place: "æ±äº¬é§…" },
            { title: "è‡ªç”±æ´»å‹•ï¼ˆæš–æ©Ÿæ—¥ï¼‰", sub: "æ–°å®¿ï¼æµ…è‰ å¤•é£Ÿï¼ˆä½æ–°å®¿å¯é€›å”å‰è¨¶å¾·ï¼‰", place: "æ–°å®¿é§…" },
            { title: "è‹¥æŠµé”æ—©ï¼šæ™´ç©ºå¡”ï¼æ·ºè‰å¯ºæ•£æ­¥", sub: "ã‚¹ã‚«ã‚¤ãƒ„ãƒªãƒ¼ãƒ»æµ…è‰å¯º", place: "æ±äº¬ã‚¹ã‚«ã‚¤ãƒ„ãƒªãƒ¼" }
          ]
        },
        {
          labelZh: "DAY2",
          labelJp: "è²·ã„ç‰©",
          date: "2026-12-01",
          items: [
            { title: "æ± è¢‹å¤ªé™½åŸ", sub: "Sunshine City", place: "æ± è¢‹ ã‚µãƒ³ã‚·ãƒ£ã‚¤ãƒ³ã‚·ãƒ†ã‚£" },
            { title: "æ°´æ—é¤¨ï¼PokÃ©mon Center", sub: "ã‚µãƒ³ã‚·ãƒ£ã‚¤ãƒ³æ°´æ—é¤¨ãƒ»ãƒã‚±ãƒ¢ãƒ³ã‚»ãƒ³ã‚¿ãƒ¼", place: "ã‚µãƒ³ã‚·ãƒ£ã‚¤ãƒ³æ°´æ—é¤¨" },
            { title: "Animateï¼ç„¡å°è‰¯å“", sub: "ã‚¢ãƒ‹ãƒ¡ã‚¤ãƒˆãƒ»ç„¡å°è‰¯å“", place: "ã‚¢ãƒ‹ãƒ¡ã‚¤ãƒˆæ± è¢‹æœ¬åº—" },
            { title: "æ™šä¸Šï¼šè²“é ­é·¹å’–å•¡ï¼ˆé ç´„ï¼‰æˆ– Round One", sub: "ãƒ•ã‚¯ãƒ­ã‚¦ã‚«ãƒ•ã‚§ï¼ãƒœã‚¦ãƒªãƒ³ã‚°ãƒ»ã‚«ãƒ©ã‚ªã‚±", place: "Round1 æ± è¢‹åº—" }
          ]
        },
        {
          labelZh: "DAY3",
          labelJp: "æ•£æ­©",
          date: "2026-12-02",
          items: [
            { title: "æ˜æ²»ç¥å®®", sub: "æ˜æ²»ç¥å®® å‚æ‹", place: "æ˜æ²»ç¥å®®" },
            { title: "ç«¹ä¸‹é€šï¼šå¯éº—é¤…ï¼ç« é­šç‡’", sub: "ç«¹ä¸‹é€šã‚Š ã‚¹ã‚¤ãƒ¼ãƒ„", place: "ç«¹ä¸‹é€šã‚Š" },
            { title: "è¡¨åƒé“å’–å•¡ï¼æ—©åˆé¤", sub: "Blue Bottle / bills", place: "è¡¨å‚é“" },
            { title: "æ¾€è°· Sky å¤œæ™¯", sub: "æ¸‹è°·ã‚¹ã‚«ã‚¤ å¤œæ™¯", place: "SHIBUYA SKY" }
          ]
        },
        {
          labelZh: "DAY4",
          labelJp: "é­”æ³•",
          date: "2026-12-03",
          items: [
            { title: "æ±äº¬è¿ªå£«å°¼ï¼ˆæ•´å¤©ï¼‰", sub: "æœä¸€å…¥åœ’ï½œPremier Accessï¼å¤œé–“éŠè¡Œï¼‹ç…™ç«ï¼ˆè‹¥æœ‰ï¼‰", place: "æ±äº¬ãƒ‡ã‚£ã‚ºãƒ‹ãƒ¼ãƒ©ãƒ³ãƒ‰" }
          ]
        },
        {
          labelZh: "DAY5",
          labelJp: "å›å¾©",
          date: "2026-12-04",
          items: [
            { title: "ä¼‘æ¯ï¼‹è³¼ç‰©ç·©è¡æ—¥", sub: "è¿ªå£«å°¼å¾Œè‚Œè‚‰æ¢å¾©æ—¥", place: "éŠ€åº§" },
            { title: "ğŸ›’ éŠ€åº§è³¼ç‰©ç‰ˆ", sub: "Uniqlo æ——è‰¦ï¼GUï¼ä¸‰è¶Šï¼Loft", place: "UNIQLO éŠ€åº§åº—" },
            { title: "ğŸ§‹ ä¸‹åˆèŒ¶ç‰ˆï¼ˆå¯é¸ï¼‰", sub: "å…­æœ¬æœ¨æ£®ç¾è¡“é¤¨ï¼TeamLab Borderlessï¼ˆéœ€é ç´„ï¼‰", place: "teamLab Borderless" },
            { title: "ğŸ› Chill æ”¾é¬†ç‰ˆï¼ˆå¯é¸ï¼‰", sub: "æº«æ³‰ï¼Spa", place: "å¤§æ±Ÿæˆ¸æ¸©æ³‰ç‰©èª" },

            { title: "ğŸƒ Level 2ï¼šå‰åœåŠ›æ§æœ€æ„›ï¼ˆå¯æ›¿æ›æˆä»Šæ—¥ä¸»ç·šï¼‰", sub: "äº•ä¹‹é ­å…¬åœ’â†’å‰åœåŠ›ç¾è¡“é¤¨â†’å‰ç¥¥å¯ºå•†åº—è¡—", place: "ä¸‰é·¹ã®æ£®ã‚¸ãƒ–ãƒªç¾è¡“é¤¨" },
            { title: "å‰ç¥¥å¯ºï¼šDonguri ã©ã‚“ãã‚Šå…±å’Œåœ‹", sub: "ã‚¸ãƒ–ãƒªå…¬å¼ã‚·ãƒ§ãƒƒãƒ—", place: "ã©ã‚“ãã‚Šå…±å’Œå›½ å‰ç¥¥å¯ºåº—" },
            { title: "èŒ¶æˆ¿æ­¦è—é‡æ–‡åº«ï¼å°ç¬¹ï¼Harmonica Yokocho", sub: "é­”å¥³å®…æ€¥ä¾¿ vibes", place: "èŒ¶æˆ¿æ­¦è”µé‡æ–‡åº«" }
          ]
        },
        {
          labelZh: "DAY6",
          labelJp: "èŠ±ç«",
          date: "2026-12-05",
          items: [
            { title: "å°å ´ DiverCity çœ‹é‹¼å½ˆ", sub: "ã‚¬ãƒ³ãƒ€ãƒ ", place: "ãƒ€ã‚¤ãƒãƒ¼ã‚·ãƒ†ã‚£æ±äº¬ ãƒ—ãƒ©ã‚¶" },
            { title: "Decks Tokyo Beach æ¼«æ­¥", sub: "ãŠå°å ´ æ•£æ­©", place: "ãƒ‡ãƒƒã‚¯ã‚¹æ±äº¬ãƒ“ãƒ¼ãƒ" },
            { title: "â­ å°å ´ç…™ç«ç¯€", sub: "èŠ±ç«å¤§ä¼šï¼ˆæµªæ¼« Ending Dayï¼‰", place: "ãŠå°å ´æµ·æµœå…¬åœ’" }
          ]
        },
        {
          labelZh: "DAY7",
          labelJp: "å¸°å›½",
          date: "2026-12-05",
          items: [
            { title: "å›å®¶å‰æ¡è²·", sub: "ä¸Šé‡é˜¿ç¾æ©«ç”ºï¼Bic Cameraï¼Yodobashi", place: "ã‚¢ãƒ¡ãƒ¤æ¨ªä¸" },
            { title: "å‰å¾€æ©Ÿå ´ âœˆï¸", sub: "æˆç”°ï¼ç¾½ç”°", place: "æˆç”°ç©ºæ¸¯" }
          ]
        }
      ]
    };

    // é€±åˆ¥é¡¯ç¤ºï¼ˆä¸­/æ—¥ï¼‰
    const weekdayZh = ["é€±æ—¥", "é€±ä¸€", "é€±äºŒ", "é€±ä¸‰", "é€±å››", "é€±äº”", "é€±å…­"];
    const weekdayJp = ["æ—¥æ›œæ—¥", "æœˆæ›œæ—¥", "ç«æ›œæ—¥", "æ°´æ›œæ—¥", "æœ¨æ›œæ—¥", "é‡‘æ›œæ—¥", "åœŸæ›œæ—¥"];

    function fmtYmd(ymd) {
      const d = new Date(ymd + "T00:00:00");
      const w = d.getDay();
      return `${ymd.replaceAll('-', '/')}ï¼ˆ${weekdayZh[w]}ï½œ${weekdayJp[w]}ï¼‰`;
    }

    // ====== UI Render ======
    function save() {
      localStorage.setItem("emenuTokyo", JSON.stringify(data));
    }

    function openMap(place) {
      const url = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(place)}`;
      location.href = url;
    }

    function renderHeaderDate() {
      document.getElementById("dateRange").innerHTML =
        `å‡ºç™¼ï½œ${fmtYmd(START_DATE)}<br>å›ç¨‹ï½œ${fmtYmd(END_DATE)}`;
    }

    function renderDayTabs() {
      const box = document.getElementById("dayTabs");
      box.innerHTML = "";

      data.days.forEach((d, idx) => {
        const dayNo = idx + 1;
        const wx = dailyWeather[d.date];
        const icon = wx ? weatherIcon(wx) : "â³";

        const tab = document.createElement("div");
        tab.className = "dayTab" + (dayNo === data.selectedDay ? " active" : "");
        tab.onclick = () => {
          data.selectedDay = dayNo;
          save();
          renderTrip();
          renderDayTabs();
        };

        tab.innerHTML = `
      <div class="d">Day ${dayNo}ï½œ${d.labelJp} ${icon}</div>
      <div class="num">
        ${String(new Date(d.date).getDate()).padStart(2, "0")}
      </div>
    `;
        box.appendChild(tab);
      });
    }


    function renderTrip() {
      const dayIndex = data.selectedDay - 1;
      const day = data.days[dayIndex];
      const list = document.getElementById("tripList");
      list.innerHTML = "";

      day.items.forEach((it, i) => {
        const spent = getTripExpenseSum(dayIndex, it.title);

        const el = document.createElement("div");
        el.className = "itemCard";
        el.innerHTML = `
      <div class="itemTop">
        <div>
          <div class="itemTitle">${escapeHtml(it.title)}</div>
          <div class="itemSub">${escapeHtml(it.sub || "")}</div>

          <div style="margin-top:10px; display:flex; gap:6px; flex-wrap:wrap;">
            <span class="badge">ğŸ“ ${escapeHtml(it.place || "æœªè¨­å®šåœ°é»")}</span>

            ${spent > 0 ? `
              <span class="badge"
                style="cursor:pointer;background:rgba(255,215,160,.9);font-weight:900"
                onclick="openExpenseFromTrip(${dayIndex}, '${escapeAttr(it.title)}')">
                ğŸ’´ Â¥${spent.toLocaleString()}
              </span>
            ` : ``}
          </div>
        </div>

        <div style="display:flex;flex-direction:column;gap:10px;align-items:flex-end;">
          <button class="btnMap" onclick="openMap('${escapeAttr(it.place || "")}')">å°èˆª MAP</button>
          <button class="btnGhost" onclick="editItem(${i})">âœï¸ ç·¨è¼¯</button>
        </div>
      </div>
    `;
        list.appendChild(el);
      });
    }

    function openExpenseFromTrip(dayIndex, title) {
      switchPage('expense', document.querySelector('.bItem:nth-child(3)'));

      const key = `${dayIndex}|${title}`;

      setTimeout(() => {
        document.querySelectorAll("#expenseList .simpleCard").forEach(card => {
          if (card.innerHTML.includes(key)) {
            card.style.boxShadow = "0 0 0 3px rgba(255,159,58,.6)";
            card.scrollIntoView({ behavior: "smooth", block: "center" });
          }
        });
      }, 200);
    }



    function renderMapList() {
      const box = document.getElementById("mapList");
      box.innerHTML = "";
      data.days.forEach((d, idx) => {
        const wrap = document.createElement("div");
        wrap.className = "simpleCard";
        wrap.innerHTML = `
        <div class="rowBetween">
          <div>
            <b>Day ${idx + 1}</b> <span class="muted">ï½œ${escapeHtml(d.labelJp)}</span><br>
            <span class="tiny">${fmtYmd(d.date)}</span>
          </div>
          <button class="btnGhost" onclick="openDayRoute(${idx + 1})">ğŸ§­ è·¯ç·š</button>
        </div>
        <div style="margin-top:10px;"></div>
        <div id="mapDay${idx + 1}"></div>
      `;
        box.appendChild(wrap);

        const inner = wrap.querySelector(`#mapDay${idx + 1}`);
        d.items.forEach(it => {
          const line = document.createElement("div");
          line.style.margin = "10px 0";
          line.innerHTML = `
          <div class="rowBetween" style="gap:12px;">
            <div>
              <div style="font-weight:900">${escapeHtml(it.title)}</div>
              <div class="tiny">ğŸ“ ${escapeHtml(it.place || "æœªè¨­å®š")}</div>
            </div>
            <button class="btnMap" style="min-width:92px" onclick="openMap('${escapeAttr(it.place || "")}')">MAP</button>
          </div>
        `;
          inner.appendChild(line);
        });
      });
    }

    // ====== Pages ======
    function switchPage(tab, el) {
      document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
      document.querySelectorAll(".bItem").forEach(b => b.classList.remove("active"));
      document.getElementById(`page-${tab}`).classList.add("active");
      el.classList.add("active");

      if (tab === "map") renderMapList();
    }

    // ====== Add/Edit ======
    function addItem() {
      const day = data.days[data.selectedDay - 1];
      const title = prompt("æ–°å¢é …ç›®æ¨™é¡Œï¼ˆä¸­æ–‡/æ—¥æ–‡çš†å¯ï¼‰");
      if (!title) return;
      const sub = prompt("è£œå……èªªæ˜ï¼ˆå¯ç•™ç©ºï¼‰", "");
      const place = prompt("åœ°é»ï¼ˆçµ¦ MAP ç”¨ï¼Œå»ºè­°æ—¥æ–‡æ›´æº–ï¼‰", "æ±äº¬é§…");
      day.items.push({ title, sub, place });
      save(); renderTrip(); renderMapList();
    }

    function editItem(index) {
      const day = data.days[data.selectedDay - 1];
      const it = day.items[index];
      const title = prompt("ä¿®æ”¹æ¨™é¡Œ", it.title);
      if (title === null) return;
      const sub = prompt("ä¿®æ”¹è£œå……èªªæ˜", it.sub || "");
      if (sub === null) return;
      const place = prompt("ä¿®æ”¹åœ°é»ï¼ˆMAPï¼‰", it.place || "");
      if (place === null) return;
      it.title = title;
      it.sub = sub;
      it.place = place;
      save(); renderTrip(); renderMapList();
    }

    // ====== Routes ======
    function openDayRoute(dayNo) {
      const d = data.days[dayNo - 1];
      const pts = d.items.map(x => x.place).filter(Boolean);
      if (pts.length < 2) {
        alert("æ­¤æ—¥åœ°é»ä¸è¶³ï¼ˆè‡³å°‘éœ€è¦å…©å€‹åœ°é»ï¼‰");
        return;
      }

      const origin = pts[0];
      const destination = pts[pts.length - 1];
      const waypoints = pts.slice(1, -1).join("|");

      const url =
        `https://www.google.com/maps/dir/?api=1` +
        `&origin=${encodeURIComponent(origin)}` +
        `&destination=${encodeURIComponent(destination)}` +
        `&waypoints=${encodeURIComponent(waypoints)}`;

      location.href = url; 
    }


    function openTodayRoute() {
      openDayRoute(data.selectedDay);
    }

    // ====== Helpers ======
    function escapeHtml(s) {
      return String(s || "")
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }
    function escapeAttr(s) {
      return String(s || "")
        .replaceAll("\\", "\\\\")
        .replaceAll("'", "\\'")
        .replaceAll("\n", " ")
        .replaceAll("\r", " ");
    }

    function weatherIcon(main) {
      const map = {
        Clear: "â˜€ï¸",
        Clouds: "â›…",
        Rain: "ğŸŒ§ï¸",
        Drizzle: "ğŸŒ¦ï¸",
        Thunderstorm: "â›ˆï¸",
        Snow: "â„ï¸",
        Mist: "ğŸŒ«ï¸",
        Fog: "ğŸŒ«ï¸"
      };
      return map[main] || "â›…";
    }

    async function loadDailyForecast() {
      try {
        const url = `https://api.openweathermap.org/data/2.5/forecast?lat=${TOKYO_LAT}&lon=${TOKYO_LON}&units=metric&appid=${OPENWEATHER_API_KEY}`;
        const res = await fetch(url);
        const json = await res.json();

        dailyWeather = {};

        json.list.forEach(item => {
          // å–æ¯å¤©ä¸­åˆ 12:00 å·¦å³
          if (item.dt_txt.includes("12:00:00")) {
            const date = item.dt_txt.split(" ")[0]; // yyyy-mm-dd
            dailyWeather[date] = item.weather[0].main;
          }
        });

        // æŠ“å®Œå¾Œé‡ç•« Day Tabs
        renderDayTabs();

      } catch (err) {
        console.error("æ¯æ—¥å¤©æ°£é å ±è®€å–å¤±æ•—", err);
      }
    }


    async function loadWeather() {
      try {
        const url = `https://api.openweathermap.org/data/2.5/weather?lat=${TOKYO_LAT}&lon=${TOKYO_LON}&units=metric&lang=zh_tw&appid=${OPENWEATHER_API_KEY}`;
        const res = await fetch(url);
        const data = await res.json();

        // æº«åº¦
        document.getElementById("tempBox").textContent =
          Math.round(data.main.temp) + "Â°C";

        // å¤©æ°£æè¿°ï¼ˆç¹ä¸­ï¼‰
        document.getElementById("wxDesc").textContent =
          data.weather[0].description;

        // iconï¼ˆç°¡å–®åˆ¤æ–·ï¼‰
        const main = data.weather[0].main;
        const iconBox = document.querySelector(".wxIcon");

        const iconMap = {
          Clear: "â˜€ï¸",
          Clouds: "â›…",
          Rain: "ğŸŒ§ï¸",
          Drizzle: "ğŸŒ¦ï¸",
          Thunderstorm: "â›ˆï¸",
          Snow: "â„ï¸",
          Mist: "ğŸŒ«ï¸",
          Fog: "ğŸŒ«ï¸"
        };

        iconBox.textContent = iconMap[main] || "â›…";

      } catch (err) {
        console.error("å¤©æ°£è®€å–å¤±æ•—", err);
        document.getElementById("wxDesc").textContent = "å¤©æ°£è³‡æ–™è®€å–å¤±æ•—";
      }
    }


    async function loadRate() {
      try {
        const res = await fetch(
          "https://api.exchangerate.host/latest?base=JPY&symbols=TWD"
        );
        const data = await res.json();
        const rate = Number(data.rates.TWD);

        currentRate = rate; // âœ… å­˜æˆå…¨åŸŸ

        document.getElementById("rateBox").innerHTML =
          `ç›®å‰åŒ¯ç‡ï½œ<b>1 JPY â‰ˆ ${rate.toFixed(3)} TWD</b>`;

        renderExpenses(); // â­ åŒ¯ç‡æ›´æ–°å¾Œé‡ç®—è¨˜å¸³

      } catch (err) {
        console.error("åŒ¯ç‡è®€å–å¤±æ•—", err);
      }
    }


    function renderCountdown() {
      const today = new Date();
      today.setHours(0, 0, 0, 0);

      const start = new Date(START_DATE + "T00:00:00");
      const diffMs = start - today;
      const diffDays = Math.ceil(diffMs / (1000 * 60 * 60 * 24));

      const box = document.getElementById("countdownBox");

      if (diffDays > 0) {
        box.innerHTML = `âœˆï¸ è·é›¢å‡ºç™¼é‚„æœ‰ <b>${diffDays}</b> å¤©`;
      } else if (diffDays === 0) {
        box.innerHTML = `ğŸ‰ ä»Šå¤©å‡ºç™¼ï¼ç¥æ—…é€”å¹³å®‰`;
      } else {
        box.innerHTML = `ğŸ§³ æ—…ç¨‹é€²è¡Œä¸­ / å·²å‡ºç™¼`;
      }
    }


    // ====== Expense è¨˜å¸³åŠŸèƒ½ ======
    let expenses = JSON.parse(localStorage.getItem("tokyoExpenses")) || [];
    let currentRate = 0.27; // fallback

    function saveExpenses() {
      localStorage.setItem("tokyoExpenses", JSON.stringify(expenses));
    }

    function getDayInfo(dateISO) {
      const d = new Date(dateISO);
      const start = new Date(START_DATE + "T00:00:00");
      const diff = Math.floor((d - start) / 86400000);
      return {
        dayNo: diff + 1,
        label: `Day ${diff + 1}`
      };
    }

    let editingExpenseIndex = null;

    function openExpenseSheet(index = null) {
      editingExpenseIndex = index;

      document.getElementById("expenseSheet").style.display = "block";

      // è¡Œç¨‹ä¸‹æ‹‰
      const tripSel = document.getElementById("exTrip");
      tripSel.innerHTML = `<option value="">â€” ä¸é—œè¯ â€”</option>`;
      data.days.forEach((d, di) => {
        d.items.forEach(it => {
          const opt = document.createElement("option");
          opt.value = `${di}|${it.title}`;
          opt.textContent = `Day ${di + 1}ï½œ${it.title}`;
          tripSel.appendChild(opt);
        });
      });

      if (index !== null) {
        const e = expenses[index];
        document.getElementById("exAmount").value = e.amount;
        document.getElementById("exCategory").value = e.category;
        document.getElementById("exNote").value = e.note || "";
        tripSel.value = e.tripKey || "";
      }
    }

    function closeExpenseSheet() {
      editingExpenseIndex = null;
      document.getElementById("expenseSheet").style.display = "none";
    }

    function saveExpenseSheet() {
      const amountRaw = document.getElementById("exAmount").value;
      const amount = Number(amountRaw);

      if (amountRaw === "" || isNaN(amount) || amount <= 0) {
        alert("è«‹è¼¸å…¥æ­£ç¢ºçš„é‡‘é¡");
        return;
      }

      const category = document.getElementById("exCategory").value;
      const note = document.getElementById("exNote").value;
      const tripKey = document.getElementById("exTrip").value;

      const rec = {
        amount,
        category,
        note,
        tripKey,
        dayNo: data.selectedDay,
        date: data.days[data.selectedDay - 1].date, // Day å°é½Š
        time: new Date().toISOString()
      };

      if (editingExpenseIndex !== null) {
        expenses[editingExpenseIndex] = rec;
      } else {
        expenses.push(rec);
      }

      saveExpenses();
      closeExpenseSheet();
      renderExpenses();
    }




    function deleteExpense(i) {
      if (!confirm("åˆªé™¤é€™ç­†è¨˜å¸³ï¼Ÿ")) return;
      expenses.splice(i, 1);
      saveExpenses();
      renderExpenses();
    }

    function renderExpenses() {
      //renderExpenseDayTabs();

      const list = document.getElementById("expenseList");
      list.innerHTML = "";

      let totalJPY = 0;
      let catSum = {};

      expenses.forEach((e, i) => {
        totalJPY += e.amount;
        catSum[e.category] = (catSum[e.category] || 0) + e.amount;

        const dayLabel = `Day ${e.dayNo}`;
        //if (expenseDayFilter && e.dayNo !== expenseDayFilter) return;

        const div = document.createElement("div");
        div.className = "simpleCard";
        div.innerHTML = `
      <div class="expenseRow">
        <div>
          <b>${e.category}</b>
          <div class="expenseMeta">
            Day ${e.dayNo} ï½œ Â¥${e.amount.toLocaleString()} â‰ˆ NT$ ${(e.amount * currentRate).toFixed(0)}
          </div>
        </div>
        <div class="expenseActions">
          <button class="btnGhost" onclick="openExpenseSheet(${i})">âœï¸</button>
          <button class="btnGhost" onclick="deleteExpense(${i})">ğŸ—‘</button>
        </div>
      </div>
    `;
        list.appendChild(div);
      });

      document.getElementById("expenseTotalJPY").textContent = totalJPY.toLocaleString();
      document.getElementById("expenseTotalTWD").textContent =
        (totalJPY * currentRate).toFixed(0);

      renderPie(catSum);
    }

    function renderPie(catSum) {
      const total = Object.values(catSum).reduce((a, b) => a + b, 0);
      let deg = 0;
      let stops = [];

      Object.entries(catSum).forEach(([_, v]) => {
        const d = (v / total) * 360;
        stops.push(`hsl(${deg},70%,70%) ${deg}deg ${deg + d}deg`);
        deg += d;
      });

      document.getElementById("expensePie").innerHTML =
        `<div class="pie" style="--pie:${stops.join(",")}"></div>`;
    }

    function exportExpenseCSV() {
      let csv = "æ—¥æœŸ,Day,åˆ†é¡,æ—¥åœ“,å°å¹£,ä»˜æ¬¾,å‚™è¨»\n";
      expenses.forEach(e => {
        const day = getDayInfo(e.date);
        csv += `${e.date},${day.label},${e.category},${e.amount},${(e.amount * currentRate).toFixed(0)},,${e.note}\n`;

      });

      const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "tokyo_expense.csv";
      a.click();
    }


    //let expenseDayFilter = 0; // 0 = å…¨éƒ¨

    function renderExpenseDayTabs() {
      const box = document.getElementById("expenseDayTabs");
      box.innerHTML = "";

      const all = document.createElement("div");
      all.className = "dayTab" + (expenseDayFilter === 0 ? " active" : "");
      all.textContent = "å…¨éƒ¨";
      all.onclick = () => { expenseDayFilter = 0; renderExpenses(); };
      box.appendChild(all);

      data.days.forEach((d, i) => {
        const tab = document.createElement("div");
        tab.className = "dayTab" + (expenseDayFilter === i + 1 ? " active" : "");
        tab.textContent = `Day ${i + 1}`;
        tab.onclick = () => {
          expenseDayFilter = i + 1;
          renderExpenses();
        };
        box.appendChild(tab);
      });
    }

    function getTripExpenseSum(dayIndex, title) {
      const key = `${dayIndex}|${title}`;
      return expenses
        .filter(e => e.tripKey === key)
        .reduce((sum, e) => sum + e.amount, 0);
    }




    // ====== Init ======
    renderHeaderDate();
    renderDayTabs();
    renderTrip();
    renderCountdown();
    renderExpenses();


    // APIè³‡æ–™
    loadWeather();
    loadRate();
    loadDailyForecast();


  </script>

  <!-- Expense Sheet -->
  <div id="expenseSheet" style="display:none; position:fixed; inset:0; z-index:999;">
    <div onclick="closeExpenseSheet()" style="position:absolute; inset:0; background:rgba(0,0,0,.3)"></div>
    <div style="
    position:absolute; bottom:0; left:0; right:0;
    background:#fff; border-radius:24px 24px 0 0;
    padding:20px; max-height:80vh; overflow:auto;">

      <h3 style="margin-top:0">ğŸ’´ è¨˜ä¸€ç­†èŠ±è²»</h3>

      <label>é‡‘é¡ï¼ˆæ—¥åœ“ï¼‰</label>
      <input id="exAmount" type="number" style="width:100%; padding:10px; margin-bottom:8px">

      <label>åˆ†é¡</label>
      <select id="exCategory" style="width:100%; padding:10px; margin-bottom:8px">
        <option>ğŸ´ åƒ</option>
        <option>ğŸšƒ äº¤é€š</option>
        <option>ğŸ è³¼ç‰©</option>
        <option>ğŸ« é–€ç¥¨</option>
        <option>ğŸ¨ ä½å®¿</option>
      </select>

      <label>é—œè¯è¡Œç¨‹ï¼ˆå¯é¸ï¼‰</label>
      <select id="exTrip" style="width:100%; padding:10px; margin-bottom:8px"></select>

      <label>å‚™è¨»</label>
      <input id="exNote" style="width:100%; padding:10px; margin-bottom:12px">

      <button class="btnPill primary" style="width:100%" onclick="saveExpenseSheet()">å„²å­˜</button>
    </div>
  </div>

</body>

</html>
